# PRD：既存ツールの実現可能性を推定するアプリ（B2B向け） v0.1
最終更新: 2025-10-01
作成: アイディア壁打ち - Vibe Learning

---

## 1. 目的 / 背景
- **目的**: 顧客からの「このアプリでどこまでできるか？」という詳細問合せに対し、**根拠付きで迅速に実現可能性（％）と実装アプローチ**を返すことで、担当者の対応時間を削減し、コア業務へ集中させる。
- **背景**: B2B企業で製品・アプリの問い合わせが頻発。社内の仕様書・要件定義・FAQ・導入事例など**100件以上のWord文書**を参照する必要があり、回答のばらつきとリードタイムが課題。
- **成功イメージ（北極星KPI）**: 問い合わせ→一次回答までの**中央値5分以内**、**根拠提示率90%**、人手判定の**実用精度≥70%**。

---

## 2. 想定ユーザー / ユースケース
- **一次ユーザー**: セールス/CS/プリセールス。顧客の要件を投げて即時に可否と代替案を把握。
- **支援ユーザー**: PM/技術支援。曖昧要求の解像度を上げ、回答を標準化。
- **ユースケース例**:
  1) 顧客が「Word一括インポート後の自動タグ付け」要望→**可否％ + 参考根拠 + 実装ステップ + 期間目安**を即返答。
  2) RFPの条項に対し**適合/要カスタム/非対応**を判定し、リスクを明示。

---

## 3. 課題（As-Is）
- 回答が人依存で品質がばらつく、検索に時間を要する。
- 文書が散在（Word中心）。**最新/適用範囲/制約**が見落とされがち。
- 社外提示可能な表現・根拠の線引きが難しい。

---

## 4. 解決策（To-Be）
- **RAG（Retrieval-Augmented Generation）**で社内文書から根拠を抽出し、**実現可能性スコア**と**推奨アプローチ**を自動生成。
- **証拠リンク/抜粋**を並記し、人がすぐレビュー・編集。
- **禁止/制約ルール**を判定に組み込み、誤約束を防ぐ。

---

## 5. スコープ（MVP）
- **対象文書**: Word(.docx)中心、100〜300件／テナント。
- **質問タイプ**: 機能可否、制約の有無、概算アプローチ、期間目安（粗いレンジ）。
- **非対象**: 見積金額の自動算出、法的拘束力のある回答、コード自動生成。

---

## 6. 主要ユーザーストーリー（PoCは3本）
1. **CSとして**、顧客要望を1文で投げると、**可否％と根拠**が3つ以内で返る。
2. **セールスとして**、**非対応/要カスタム**の場合は**代替案**と**期待効果**が返る。
3. **PMとして**、回答に使われた**根拠文書のバージョン/日付**を確認できる。

---

## 7. 機能要件（MVP）
| 機能 | ステータス | 初期スコープ | 備考 |
|---|---|---|---|
| ログイン/認可(メール+PW or SSO) | **Must** | 最低限のテナント分離 | 監査ログ必須 |
| 事前資料アップロード(.docx) | **Must** | 複数一括、メタ情報付与 | 最大50MB/件想定 |
| コンテンツ抽出&分割 | **Must** | 見出し/表含むテキスト抽出 | 失敗時のリトライ |
| ベクトル化/索引 | **Must** | pgvector or Qdrant | 文章/セクション単位 |
| 検索→回答生成(RAG) | **Must** | 上位根拠3件 + 要約 | 引用表示必須 |
| 実現可能性スコア | **Must** | 後述スコア式で％出力 | 信頼区間付き表示 |
| プロンプト雛形生成 | **Must** | 文書向け&顧客向け2種 | 体裁テンプレあり |
| 管理UI(文書/インデックス) | **Nice** | 再インデックス、無効化 | 監査のため最優先級次点 |
| レート制御/キュー | **Nice** | 同時実行制御 | 無料枠対策 |
| 評価ダッシュボード | **Nice** | 正答率/根拠提示率 | CSVエクスポート |

---

## 8. 非機能要件
- **性能**: 問合せ→初回回答 **≤ 8秒**（P95, 参考: 1,500トークン級）。
- **可用性**: 平日9-19時SLA 99.5%。
- **セキュリティ**: テナント分離、PII最小化、転送/保存時暗号化、**アップロード禁止語/外部秘フラグ**検出。
- **監査性**: 入出力ログ、参照根拠、モデル/プロンプトバージョンの記録。

---

## 9. 画面設計（ラフ）
- **ホーム**: 入力テキスト、過去質問、ドラフト回答一覧。
- **回答画面**: ①可否％ + ラベル（対応/要カスタム/非対応） ②根拠（ハイライト付）③推奨アプローチ（箇条書き）④期間レンジ ⑤リスク注意。
- **文書管理**: アップロード履歴、インデックス状態、バージョン/有効・無効。

---

## 10. データ/アーキテクチャ概要
- **フロント**: Next.js/TypeScript/React。
- **バックエンド**: Laravel(PHP) API。ジョブキューで**抽出→分割→埋め込み→格納**を非同期処理。
- **AI**: Gemini API（無料枠でPoC）、**埋め込みモデル** + **生成モデル**を利用。
- **ストレージ**: S3互換(原本), PostgreSQL + **pgvector**(埋め込み), Redis(キュー)。
- **認証**: NextAuth or Auth0 or Laravel Sanctum。
- **監査**: 永続ログ（質問, 返答, 参照ID, モデルver, プロンプトver）。

**データフロー**:
1) .docxアップロード → 抽出（段落/表） → チャンク分割(例: 500-1000字) → 埋め込み → ベクトル格納。
2) 質問受領 → 類似検索(top-k, 多義性対策に再ランキング) → ルール判定 → 生成モデルで回答/スコア → UI表示。

---

## 11. AI設計（RAG）
- **前処理**: h1-h3/表/箇条書き保持、テンプレ/旧版検知、重複排除。
- **検索**: BM25 + ベクトルのハイブリッド（可能なら）。
- **プロンプト**: 役割/禁止事項/出力フォーマット固定（JSON構造＋自然文）。
- **ガードレール**: 禁止語辞書、社外秘検知、信頼度しきい値未達なら**保留**を返す。

---

## 12. 実現可能性スコア算出（v0の式）
- **出力**: `score_pct (0-100)`, `band (High/Med/Low)`, `label (対応/要カスタム/非対応)`, `rationale`。
- **要素**:
  - **E1: 根拠カバレッジ**（該当セクション数/必要観点）
  - **E2: ルール整合**（禁止/制約/サポートの一致度）
  - **E3: 複雑度逆数**（必要コンポーネント数、依存、未知API）
  - **E4: 類似成功事例の有無**（ナレッジ/FAQでの成功ケース）
  - **P: 罰則**（根拠年代が古い、矛盾、OOS検知）
- **簡易式**: `score = clamp( w1*E1 + w2*E2 + w3*E3 + w4*E4 - P , 0, 100 )`
- **初期重み**: w1=0.35, w2=0.25, w3=0.20, w4=0.20。
- **校正**: 人手ラベル(対応/要カスタム/非対応)50件で**プラグマティックに重み調整**。

---

## 13. 検証計画（PoC 2週間）
- **対象**: 社内ユーザー10-15名、問い合わせ50件以上。
- **KPI**:
  - 実用精度（人手合意ラベルと一致率）≥70%
  - 根拠提示率≥90%
  - 初回応答時間P95 ≤ 8秒
  - 人手対応時間の短縮 ≥50%
- **方法**: A/Bで現行/新ツールの応答速度と訂正率を比較。誤回答はタグ付けして再学習（重み更新）。

---

## 14. 開発計画（やること）
- **W1**: 文書抽出→分割→埋め込み→格納のバッチ/キュー、RAG最小実装、プロンプト雛形、認証。
- **W2**: スコア式実装、UI（回答/根拠/期間）、監査ログ、最小ダッシュボード、パイロット運用。
- **体制目安**: FE×1, BE×1, PM/QA×0.5。

---

## 15. リスクと対策
- **幻覚/誤約束**: 根拠未満時は**保留**を返す。社外向けテンプレで確度ラベル必須。
- **無料枠制限**: レート/トークン制限→**キュー/キャッシュ/要約**で回避。将来有料枠や代替APIに切替可能な**抽象化レイヤ**。
- **機密情報**: マスキング/PII検出、外部送信ポリシーの同意、利用規約/監査。
- **文書鮮度**: 版管理/失効日、再インデックスの運用手順。

---

## 16. 法務/コンプライアンス
- データ処理同意、第三者モデル利用の開示、保存期間/削除権、**テナント境界**の明記。
- 著作権/ライセンス: 外部転載NG文書を除外、引用は社内のみ。

---

## 17. Definition of Done（PoC）
- 代表的な問い合わせ50件で**実用精度≥70%**、根拠提示率≥90%。
- P95応答≤8秒、監査ログと再現性確保（プロンプト/モデルver記録）。
- 利用者満足（CS/セールスのNPS≥+20）。

---

## 付録A：出力テンプレ（顧客向けドラフト）
```

【実現可能性】85%（High）／分類：対応
【根拠】#1 〇〇仕様v2.1（p.12-13）／#2 導入事例A（2024-09）
【推奨アプローチ】

* ステップ1: 既存モジュールXを拡張（～2週間）
* ステップ2: 外部API Y連携（～1週間）
  【留意点】
* 制約Zがあるため上限N件/日。カスタム時は+1週間。

```

## 付録B：評価シート（人手ラベル）
| 問い合わせID | 人手判定 | ツール判定 | 一致/不一致 | コメント |
|---|---|---|---|---|
| Q-001 | 対応 | 対応 | 一致 |  |

---

## 参考：将来拡張（Nice to have）
- 画像/PDF/スライド対応、FAQ自動生成、**クローズドループ学習**、Slack/Teams連携、**ナレッジギャップ検知**。


