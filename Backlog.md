# GitHub Issue バックログ（PoC：実現可能性推定アプリ）v0.1
対象：**ログイン処理は除外**／期間：**2週間PoC**

---

## 構成
- **Milestone**
  - **M1: 基盤とRAG最小実装（W1）**
  - **M2: スコア/UI/評価/運用（W2）**
- **主ラベル**: `area:ingest` `area:retrieval` `area:generation` `area:scoring` `area:ui` `area:ops` `type:backend` `type:frontend` `type:ai` `prio:P0/P1` `size:S/M/L`

---

## Milestone 概要
| Milestone | 期間 | 目的 | DoD |
|---|---|---|---|
| M1 | Week 1 | 文書→索引→RAG回答の最短経路を通す | .docx→抽出→分割→埋め込み→検索→引用付き回答が通る |
| M2 | Week 2 | 実現可能性スコア/運用/評価を実装しパイロット可能に | ％表示・ダッシュボード・評価50件・パイロット運用開始 |

---

## Issue 一覧（コピーして作成）

### [M1][P0][BE/AI] Word文書の抽出・構造化（.docx）
**目的**: .docxから本文/見出し/表を抽出して構造保持。
**完了条件**:
- 指定の.docx 10件で抽出成功率95%以上。
- 段落/見出し/表のタグ付けJSONを出力。
**タスク**:
- [ ] .docx抽出ロジック（見出し/表/箇条書き保持）
- [ ] 失敗時のフォールバック＆再試行
- [ ] 抽出結果のスキーマ定義
**ラベル**: `area:ingest` `type:backend` `prio:P0` `size:M`
**依存**: なし

---

### [M1][P0][BE] チャンク分割とメタデータ付与
**目的**: 検索適合性の高い長さに分割し、文書ID/版/セクション等のメタを付与。
**完了条件**: チャンク長の分布が500–1000字中心、メタ（doc_id, version, section, updated_at）を全件付与。
**タスク**:
- [ ] 分割戦略（見出し境界優先＋最大長）
- [ ] 旧版/重複の検出と除外
- [ ] メタ設計＆保存
**ラベル**: `area:ingest` `type:backend` `prio:P0` `size:S`
**依存**: 抽出

---

### [M1][P0][AI/BE] 埋め込み生成とpgvector格納
**目的**: チャンクに対し埋め込みを生成しpgvectorへ格納。
**完了条件**: 1万チャンク規模でスループット≥50チャンク/分、格納後に検索クエリが実行可能。
**タスク**:
- [ ] 埋め込みモデル選定（Gemini埋め込み）
- [ ] ベクトル格納/スキーマ（pgvector）
- [ ] バルク投入＆再実行設計
**ラベル**: `area:ingest` `area:retrieval` `type:ai` `type:backend` `prio:P0` `size:M`
**依存**: チャンク分割

---

### [M1][P0][BE] 類似検索API（Top-K）
**目的**: クエリに対するTop-Kベクトル検索APIを提供。
**完了条件**: APIでTop-K取得、応答≤150ms（DB内）、メタを返却。
**タスク**:
- [ ] SQL/ORM実装（cosine距離）
- [ ] K/スコア閾値の設定
- [ ] レスポンススキーマ確定
**ラベル**: `area:retrieval` `type:backend` `prio:P0` `size:S`
**依存**: 埋め込み

---

### [M1][P0][AI] RAG回答生成（引用付き）
**目的**: Top-K根拠から引用＋要約で回答を生成。
**完了条件**: 3件以内の引用を付与し、根拠テキストと出典メタを返す。
**タスク**:
- [ ] プロンプト骨子（役割/禁止事項/出力フォーマット）
- [ ] コンテキスト整形（重複/矛盾の抑制）
- [ ] 出力バリデーション（JSON＋自然文）
**ラベル**: `area:generation` `type:ai` `prio:P0` `size:M`
**依存**: 類似検索API

---

### [M1][P0][FE] 回答画面（骨組み）
**目的**: 入力→回答（％枠/ラベル/根拠/期間枠）を表示。
**完了条件**: 入力履歴、回答カード、引用ハイライトのUIを実装。
**タスク**:
- [ ] 入力欄＋送信
- [ ] 回答カード（％/ラベル/根拠/期間枠）
- [ ] 履歴リスト
**ラベル**: `area:ui` `type:frontend` `prio:P0` `size:M`
**依存**: RAG回答API

---

### [M1][P0][AI] 実現可能性スコア算出 v0（式）
**目的**: E1〜E4と罰則Pによるスコア式を実装。
**完了条件**: `score_pct`/`band`/`label`/`rationale` を返却。
**タスク**:
- [ ] 要素定義（E1:根拠, E2:整合, E3:複雑度, E4:事例, P:罰則）
- [ ] 重みw1..w4の初期値設定
- [ ] しきい値→対応/要カスタム/非対応
**ラベル**: `area:scoring` `type:ai` `prio:P0` `size:S`
**依存**: RAG回答

---

### [M1][P0][AI] ルール/禁止語ガードレール
**目的**: 社外秘/約束禁止表現を検出し保留や注記を自動付与。
**完了条件**: ルールに該当する質問は`status:hold`で返す。
**タスク**:
- [ ] 禁止語辞書/社外秘パターン
- [ ] ルールエンジン＆ポリシー
- [ ] 出力整形（注意書き）
**ラベル**: `area:generation` `type:ai` `prio:P0` `size:S`
**依存**: RAG回答

---

### [M1][P0][BE] 監査ログ（入出力/参照ID/モデルver）
**目的**: 追跡/再現性確保。
**完了条件**: 質問/回答/参照チャンクID/モデルver/プロンプトverを保存。
**タスク**:
- [ ] ログスキーマ
- [ ] 非同期書き込み
- [ ] 取得API（期間/ユーザー）
**ラベル**: `area:ops` `type:backend` `prio:P0` `size:S`
**依存**: RAG回答

---

### [M1][P0][BE] キュー基盤（Redis + Laravel Queue）
**目的**: インジェスト/生成の非同期化と制御。
**完了条件**: ジョブ再試行/デッドレターが機能。
**タスク**:
- [ ] キュー設定（優先度/再試行）
- [ ] ワーカー監視
- [ ] 失敗通知（ログ）
**ラベル**: `area:ops` `type:backend` `prio:P0` `size:S`
**依存**: なし

---

### [M1][P0][BE] 原本ストレージ（S3互換）+ 版管理
**目的**: 原本の安全保管と版の追跡。
**完了条件**: アップロード→バージョン自動採番→メタ保存。
**タスク**:
- [ ] バケット/命名規則
- [ ] 版IDと失効日の扱い
- [ ] 削除/無効化フロー
**ラベル**: `area:ingest` `type:backend` `prio:P0` `size:S`
**依存**: 抽出

---

### [M1][P1][BE] インジェストのエラーハンドリング/再試行
**目的**: 抽出/分割/埋め込みの堅牢化。
**完了条件**: 失敗率≤1%、再試行で回復。
**タスク**:
- [ ] ステップごとの失敗分類
- [ ] リトライ/スキップポリシー
- [ ] 監視メトリクス
**ラベル**: `area:ingest` `type:backend` `prio:P1` `size:S`
**依存**: キュー

---

### [M2][P0][AI] 期間レンジ推定（実装目安）
**目的**: 対応/要カスタム時の期間を短中長レンジで提示。
**完了条件**: `1–2週間/2–4週間/1–2ヶ月`のような粗いレンジを返す。
**タスク**:
- [ ] 推定ロジック（根拠の複雑度/依存数）
- [ ] 表示文言テンプレ
- [ ] 評価データでの補正
**ラベル**: `area:scoring` `type:ai` `prio:P0` `size:S`
**依存**: スコア算出

---

### [M2][P0][AI] 推奨アプローチ生成（ステップ化）
**目的**: 実装手順の箇条書き提案。
**完了条件**: 3–5ステップで一貫性のある案を返す。
**タスク**:
- [ ] テンプレ（社内向け/顧客向け）
- [ ] 根拠スニペットの引用
- [ ] 保守的表現のガイド
**ラベル**: `area:generation` `type:ai` `prio:P0` `size:S`
**依存**: RAG回答

---

### [M2][P0][FE] 回答UI 完成（スコア/ラベル/期間/根拠ハイライト）
**目的**: 実務で使える回答ビュー。
**完了条件**: スコア％とバンド、ラベル、期間レンジ、根拠ハイライト、注意文が表示。
**タスク**:
- [ ] カードUI仕上げ
- [ ] ハイライト（該当箇所）
- [ ] コピー用ドラフト（顧客向け）
**ラベル**: `area:ui` `type:frontend` `prio:P0` `size:M`
**依存**: 推奨アプローチ/期間

---

### [M2][P0][DATA] 評価データ作成（50件）& ラベリング運用
**目的**: 人手判定との一致率を測定し重みを校正。
**完了条件**: 50件の質問・正解ラベル（対応/要カスタム/非対応）・根拠が整備。
**タスク**:
- [ ] 代表問い合わせ収集
- [ ] ラベル基準の定義
- [ ] スプレッドシート整備
**ラベル**: `area:scoring` `type:ai` `type:ops` `prio:P0` `size:M`
**依存**: RAG回答

---

### [M2][P0][BE] 評価ダッシュボード（精度/根拠率/応答時間）
**目的**: KPI可視化。
**完了条件**: 一致率、根拠提示率、P95応答時間を時系列で表示。
**タスク**:
- [ ] 集計ジョブ
- [ ] 可視化（簡易でOK）
- [ ] CSVエクスポート
**ラベル**: `area:ops` `type:backend` `prio:P0` `size:M`
**依存**: 評価データ

---

### [M2][P1][FE] 文書管理UI（履歴/有効化/再インデックス）
**目的**: 文書の状態を可視化し運用を楽に。
**完了条件**: 文書一覧、版/有効・無効、再インデックスボタン。
**タスク**:
- [ ] 一覧/詳細
- [ ] 再インデックス
- [ ] 版/失効の表示
**ラベル**: `area:ui` `type:frontend` `prio:P1` `size:M`
**依存**: インジェスト

---

### [M2][P0][BE] レート制御/キャッシュ（無料枠対策）
**目的**: 無料枠での安定稼働。
**完了条件**: レート超過時の待ち行列化、同一質問のキャッシュ再利用。
**タスク**:
- [ ] レート制御（トークン/分）
- [ ] 回答キャッシュ（TTL）
- [ ] バックオフ戦略
**ラベル**: `area:ops` `type:backend` `prio:P0` `size:S`
**依存**: キュー

---

### [M2][P0][SEC] セキュリティ/コンプラ初期（PII/テナント境界）
**目的**: 機密/社外秘の漏えい防止。
**完了条件**: PII簡易検出、テナントIDによる厳密なデータ分離、利用規約提示。
**タスク**:
- [ ] PIIルール（メール/電話等）
- [ ] テナントフィルタの全API適用
- [ ] 利用規約の同意フラグ
**ラベル**: `area:ops` `type:backend` `prio:P0` `size:S`
**依存**: 監査ログ

---

### [M2][P0][OPS] パイロット運用（社内10–15名）
**目的**: 本番想定の試用でボトルネック洗い出し。
**完了条件**: 50件の実問合せでKPIを測定、改善リスト作成。
**タスク**:
- [ ] パイロット対象選定/説明
- [ ] 問い合わせ収集/モニタリング
- [ ] 振り返り/改善計画
**ラベル**: `area:ops` `type:other` `prio:P0` `size:M`
**依存**: すべてのM2コア

---

### [M2][P0][AI] プロンプト雛形（社内/顧客向け）
**目的**: 表現揺れを抑え、安全な定型出力に。
**完了条件**: 社内レビュー済みテンプレ2種（社内説明用/顧客ドラフト）。
**タスク**:
- [ ] 出力テンプレ設計
- [ ] 禁止/注意文含む文言集
- [ ] A/Bで読みやすさ比較
**ラベル**: `area:generation` `type:ai` `prio:P0` `size:S`
**依存**: 回答UI

---

### [M2][P1][OPS] 再インデックス運用手順（版管理/失効）
**目的**: 文書鮮度の担保。
**完了条件**: 版アップ時の手順、失効ルール、ロールバック手順が整備。
**タスク**:
- [ ] 手順書（Runbook）
- [ ] 監査項目
- [ ] 定期点検のリマインダ
**ラベル**: `area:ops` `type:other` `prio:P1` `size:S`
**依存**: 文書管理

---

### [M2][P1][BE] 非機能チューニング（P95≤8秒）
**目的**: 体感速度の最適化。
**完了条件**: P95応答≤8秒（1000–1500トークン級）。
**タスク**:
- [ ] コンテキスト最適化（トップK/トークン削減）
- [ ] 並列/逐次の最適化
- [ ] キャッシュヒット率向上
**ラベル**: `area:ops` `type:backend` `prio:P1` `size:M`
**依存**: RAG全体

---

### [M2][P1][DOC] ドキュメント（README/利用ガイド/FAQ）
**目的**: 利用と保守の摩擦を下げる。
**完了条件**: README、利用ガイド、FAQ（保留条件/注意文）を整備。
**タスク**:
- [ ] README（アーキ/環境変数/制限）
- [ ] 利用ガイド（スクショ）
- [ ] FAQ（よくある誤解）
**ラベル**: `area:ops` `type:other` `prio:P1` `size:S`
**依存**: 全機能

---

## 参考（将来拡張 Backlog）
- BM25とのハイブリッド検索、Slack/Teams連携、FAQ自動生成、ナレッジギャップ検知、PDF/画像対応。

